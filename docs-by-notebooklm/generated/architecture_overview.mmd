%%{init: {'theme': 'default', 'themeVariables': {'fontSize': '14px'}}}%%
flowchart TB
    subgraph Client["Browser"]
        Browser["User"]
    end

    subgraph Frontend["Frontend :3000"]
        Next["Next.js 15"]
        Editor["TipTap Editor"]
        DnD["dnd-kit"]
        Sidebar["Page Tree"]
    end

    subgraph Backend["Backend :8000"]
        API["FastAPI"]
        Service["NoteService"]
        Upload["UploadRouter"]
    end

    subgraph Data["Database :5432"]
        PG["PostgreSQL"]
        Notes["notes table"]
        Files["/uploads/"]
    end

    Browser --> Next
    Next --> API
    Editor --> API
    DnD --> Sidebar
    API --> Service
    Service --> PG
    PG --> Notes
    Upload --> Files

    classDef client fill:#FEF3C7,stroke:#F59E0B,stroke-width:2px
    classDef frontend fill:#DBEAFE,stroke:#3B82F6,stroke-width:2px
    classDef backend fill:#D1FAE5,stroke:#10B981,stroke-width:2px
    classDef data fill:#E9D5FF,stroke:#8B5CF6,stroke-width:2px

    class Browser client
    class Next,Editor,DnD,Sidebar frontend
    class API,Service,Upload backend
    class PG,Notes,Files data
